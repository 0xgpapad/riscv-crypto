
\newpage
\subsection{Scalar SM3 Acceleration}
\label{sec:scalar:sm3}

These instructions are designed to accelerate the SM3 secure
hash function\cite{ietf:sm3}.
They are based on work done in \cite{MJS:LWSHA:20}, and follow
the same pattern as the scalar SHA2 instructions
(Section \ref{sec:scalar:sha2}).

\begin{cryptoisa}
RV32, RV64
    ssm3.p1 rd, rs1
    ssm3.p0 rd, rs1
\end{cryptoisa}

The instructions implement versions of the $P_0$ and $P_1$
permutations, per the SM3 specification \cite{ietf:sm3}.
SAIL Model code for each instruction is found in figure
\ref{fig:sail:sm3}.

\begin{figure}[h]
\lstinputlisting[language=sail,firstline=106,lastline=114]{../sail/riscv_insts_crypto.sail}
\caption{SAIL specification for the scalar RV32/RV64 SM3 instructions.}
\label{fig:sail:sm3}
\end{figure}
