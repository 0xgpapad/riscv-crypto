
All instructions in the scalar cryptography extension are grouped into
{\em functional sets} and {\em feature sets}.
Functional sets are very fine grained, and are constructed around
specific algorithms, standards requirments, or small logical groupings
of instructions.
Feature sets are more coarse grained, and are what cores are expected
to implement.
The letters used to construct Functional Set names are explained in
Table \ref{tab:scalar:functional-sets}.
%Bit-manipulation instructions
%which are included in the scalar-cryptography extension are listed in
%Table \ref{tab:scalar:feature-sets:bitmanip}.

The Feature Sets for instructions exclusive to the scalar cryptography
extension are listed in
Table \ref{tab:scalar:feature-sets:crypto}.
All Bit-manipulation instructions used by the scalar cryptography extension
(see Section \ref{sec:scalar:bitmanip})
are always included in the feature sets listed in
Table \ref{tab:scalar:feature-sets:crypto}.
Exceptions are RV64 only instructions, which are not included in RV32
based implementations.

\begin{table}[h]
\centering
\begin{tabular}{cl}
Letter   & Description \\
\hline
{\tt k } & The default scalar cryptography extension, short for {\tt ZknZkr}    \\
{\tt b } & Bitmanip subset included in the scalar cryptography extension.       \\
{\tt n } & NIST algorithm suite.                                                \\
{\tt s } & ShangMi (SM) algorithm suite.                                        \\
{\tt e } & Encryption Instructions.                                             \\
{\tt d } & Decryption Instructions.                                             \\
{\tt g } & Constant time carry-less multiply for Galois/Counter Mode            \\
{\tt h } & Hash function instructions.                                          \\
{\tt r } & Entropy source.                                                      \\
\hline
\end{tabular}
\caption{
    Explanation of the letters used to create the functional set names.
    These letters are grouped to form specific functional sets.
    For example, {\tt Zkne} refers to all of the NIST AES Encryption
    instructions. Or, {\tt Zksh} refers to the ShangMi hash function instructions.
}
\label{tab:scalar:functional-sets}
\end{table}

Encryption and decryption instructions are separated into different functional
groups because some popular use cases (e.g. Galois/Counter Mode in TLS 1.3, among others)
do not require decryption functionality.

The NIST and ShangMi algorithms suites are separated because their usefulness is
heavily dependent on the countries a device is expected to operate in.
NIST ciphers are a part of most standardised internet protocols, while ShangMi ciphers are
required for use in China.

Presence of the cryptography extension in any form is indicated
by bit $10$ of the {\tt MISA} CSR.
i.e. bit ``K'', because ``C'' is taken and ``K'' is for Kappa, the
first letter of the ancient Greek word krupt√≥s,
meaning ``{\em hidden}''.
Detection of fine-grained functionality uses the mechanisms defined
by the {\tt tech-config} RISC-V Task Group.
At the time of writing, these mechanisms are still being defined.

%\begin{table}[h]
%\centering
%\begin{tabular}{lcccccc}
%\hline
%\multirow{2}{*}{Instructions} & 
%\multirow{2}{*}{Functional Set} &
%\multicolumn{3}{c}{Feature Sets}    \\
%                              &      & Zkn (RV32) & Zkn (RV64) & Zks    \\ \hline
%{\tt clmul                   }& Zkg  & \cmark     & \cmark     & \cmark \\
%{\tt clmulh                  }& Zkg  & \cmark     & \cmark     & \cmark \\
%{\tt xperm.n                 }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt xperm.b                 }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt ror                     }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt rol                     }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt rori                    }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt roriw                   }& Zkb  &            & \cmark     & \cmark \\
%{\tt andn                    }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt orn                     }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt xorn                    }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt pack                    }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt packu                   }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt packh                   }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt packw                   }& Zkb  &            & \cmark     & \cmark \\
%{\tt packuw                  }& Zkb  &            & \cmark     & \cmark \\
%{\tt grevi                   }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt gorci                   }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt shfli                   }& Zkb  & \cmark     & \cmark     & \cmark \\
%{\tt unshfli                 }& Zkb  & \cmark     & \cmark     & \cmark \\
%\hline
%\end{tabular}
%\caption{Feature sets for instructions from the Bit-manipulation extension which
%are re-used by the scalar cryptography extension.}
%\label{tab:scalar:feature-sets:bitmanip}
%\end{table}

\begin{table}[]
\centering
\begin{tabular}{lccccccc}
\hline
\multirow{2}{*}{Instructions} & 
\multirow{2}{*}{Functional Set} &
\multicolumn{4}{c}{Feature Sets}    \\
                              &      & Zkn (RV32) & Zkn (RV64) & Zks    & Zkr     \\ \hline
{\tt aes32dsi                }& Zknd & \cmark     &            &        &         \\
{\tt aes32dsmi               }& Zknd & \cmark     &            &        &         \\
{\tt aes32esi                }& Zkne & \cmark     &            &        &         \\
{\tt aes32esmi               }& Zkne & \cmark     &            &        &         \\
{\tt aes64ds                 }& Zknd &            & \cmark     &        &         \\
{\tt aes64dsm                }& Zknd &            & \cmark     &        &         \\
{\tt aes64es                 }& Zkne &            & \cmark     &        &         \\
{\tt aes64esm                }& Zkne &            & \cmark     &        &         \\
{\tt aes64im                 }& Zknd &            & \cmark     &        &         \\
{\tt aes64ks1i               }& Zkne &            & \cmark     &        &         \\
{\tt aes64ks2                }& Zkne &            & \cmark     &        &         \\
{\tt sha256sig0              }& Zknh & \cmark     & \cmark     &        &         \\
{\tt sha256sig1              }& Zknh & \cmark     & \cmark     &        &         \\
{\tt sha256sum0              }& Zknh & \cmark     & \cmark     &        &         \\
{\tt sha256sum1              }& Zknh & \cmark     & \cmark     &        &         \\
{\tt sha512sig0h             }& Zknh & \cmark     &            &        &         \\
{\tt sha512sig0l             }& Zknh & \cmark     &            &        &         \\
{\tt sha512sig1h             }& Zknh & \cmark     &            &        &         \\
{\tt sha512sig1l             }& Zknh & \cmark     &            &        &         \\
{\tt sha512sum0r             }& Zknh & \cmark     &            &        &         \\
{\tt sha512sum1r             }& Zknh & \cmark     &            &        &         \\
{\tt sha512sig0              }& Zknh &            & \cmark     &        &         \\
{\tt sha512sig1              }& Zknh &            & \cmark     &        &         \\
{\tt sha512sum0              }& Zknh &            & \cmark     &        &         \\
{\tt sha512sum1              }& Zknh &            & \cmark     &        &         \\
{\tt sm3p0                   }& Zksh &            &            & \cmark &         \\
{\tt sm3p1                   }& Zksh &            &            & \cmark &         \\
{\tt sm4ed                   }& Zkse &            &            & \cmark &         \\
{\tt sm4ks                   }& Zkse &            &            & \cmark &         \\
{\tt pollentropy             }& Zkr  &            &            &        & \cmark  \\
{\tt getnoise                }& Zkr  &            &            &        & \cmark  \\
\hline
\end{tabular}
\caption{
Feature sets for instructions exclusive to the scalar cryptography extension.
The Bit-manipulation instructions listed in Section \ref{sec:scalar:bitmanip}
are not shown, as they are always included in every subset with an appropriate
{\tt XLEN}.
}
\label{tab:scalar:feature-sets:crypto}
\end{table}

