
[[crypto_scalar_sha512_rv64]]
=== SHA512 Instructions: RV64

Synopsis::
Lightweight instructions for accelerating the SHA512 Cryptographic Hash
Function on the RV64 Base Architecture.

Mnemonic::

----
sha512sig0 rd, rs1
sha512sig1 rd, rs1
sha512sum0 rd, rs1
sha512sum1 rd, rs1
----

Encoding::
[wavedrom, , svg]
----
{reg:[
    {bits: 32, name:todo,attr:["todo"]}
]}
----

Description::
These instructions implement the four `sigma` and `sum` functions used in
the SHA512 hash function cite:[nist:fips:180:4] (Section 4.1.3).
They compute the entire `sigma` and `sum` functions
based on a single input register, and write the result to `rd`.

Operation::
[source,sail]
--
function crypto_sha512_rv64(op, rd, rs1) = {
  let inb    : bits(64) = X(rs1)[63..0];
  let result : bits(64) = match op {
    OP_SHA512_SIG0 => ror64(inb,  1) ^ ror64(inb,  8) ^ (inb >> 7),
    OP_SHA512_SIG1 => ror64(inb, 19) ^ ror64(inb, 61) ^ (inb >> 6),
    OP_SHA512_SUM0 => ror64(inb, 28) ^ ror64(inb, 34) ^ ror64(inb ,39),
    OP_SHA512_SUM1 => ror64(inb, 14) ^ ror64(inb, 18) ^ ror64(inb ,41)
  };
  X(rd) = EXTZ(result);
  RETIRE_SUCCESS
}
--

