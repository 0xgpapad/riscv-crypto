[[crypto_scalar_profiles]]
== Extension Groups

The group of extensions introduced by the Scalar Cryptography Instruction Set
Extension is listed here.

Presence of the cryptography extension in any form is indicated by bit
`10` of the MISA CSR. i.e. bit `K`, because `C` is taken
and `K` is for _Kappa_, the first letter of the ancient Greek word
_krupt√≥s_, meaning _hidden_. Detection of fine-grained functionality
uses the mechanisms defined by the tech-config RISC-V Task Group. At the
time of writing, these mechanisms are still being defined.

.Note to readers
[NOTE, caption="SH"]
====
Specialist encryption and decryption instructions are separated into different
functional groups because some popular use cases (e.g., Galois/Counter
Mode in TLS 1.3, among others) do not require decryption functionality.

The NIST and ShangMi algorithms suites are separated because their
usefulness is heavily dependent on the countries a device is expected to
operate in. NIST ciphers are a part of most standardised internet
protocols, while ShangMi ciphers are required for use in China.
====

[[crypto_scalar_ext_zkb]]
=== `Zkb` - Bitmanip instructions for Cryptography

These are a subset of the Bitmanipulation Extension which are particularly
useful for Cryptography.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; | &#10003; |  xperm.n     | <<#insn-xperm.n>>
| &#10003; | &#10003; |  xperm.b     | <<#insn-xperm.b>>
| &#10003; | &#10003; |  ror         | <<#insn-ror>>
| &#10003; | &#10003; |  rol         | <<#insn-rol>>
| &#10003; | &#10003; |  rori        | <<#insn-rori>>
|          | &#10003; |  rorw        | <<#insn-rorw>>
|          | &#10003; |  rolw        | <<#insn-rolw>>
|          | &#10003; |  roriw       | <<#insn-roriw>>
| &#10003; | &#10003; |  andn        | <<#insn-andn>>
| &#10003; | &#10003; |  orn         | <<#insn-orn>>
| &#10003; | &#10003; |  xnor        | <<#insn-xnor>>
| &#10003; | &#10003; |  pack        | <<#insn-pack>>
| &#10003; | &#10003; |  packu       | <<#insn-packu>>
| &#10003; | &#10003; |  packh       | <<#insn-packh>>
|          | &#10003; |  packw       | <<#insn-packw>>
|          | &#10003; |  packuw      | <<#insn-packuw>>
| &#10003; | &#10003; |  rev.b       | <<#insn-rev.b>>
| &#10003; | &#10003; |  rev8        | <<#insn-rev8>>
|          | &#10003; |  rev8.w      | <<#insn-rev8.w>>
| &#10003; |          |  zip         | <<#insn-zip>>
| &#10003; |          |  unzip       | <<#insn-unzip>>
|===


[[crypto_scalar_ext_zkg]]
=== `Zkg` - Carryless multiply instructions

Constant time carry-less multiply for Galois/Counter Mode.
These are separated from the <<crypto_scalar_ext_zkb>> because they
have a considerable implementation overhead which cannot be amortised
across other instructions.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; | &#10003; |  clmul       | <<#insn-clmul>>
| &#10003; | &#10003; |  clmulh      | <<#insn-clmulh>>
|===

[[crypto_scalar_ext_zkr]]
=== `Zkr` - Entropy Source Extension

Entropy source for seeding random number generators.
Both of these are pseudo-instructions, and alias particular CSR read
instructions.
See <<crypto_scalar_es>> for a complete explanation.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; | &#10003; | pollentropy  | <<crypto_scalar_es_pollentropy>>
| &#10003; | &#10003; | (getnoise)   | <<crypto_scalar_es_getnoise>>
|===


[[crypto_scalar_ext_zkne]]
=== `Zkne` - NIST Suite: AES Encryption

Instructions for accelerating the encryption and key-schedule functions of
the AES block cipher.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; |          | aes32esi     | <<#insn-aes32esi>>
| &#10003; |          | aes32esmi    | <<#insn-aes32esmi>>
|          | &#10003; | aes64es      | <<#insn-aes64es>>
|          | &#10003; | aes64esm     | <<#insn-aes64esm>>
|          | &#10003; | aes64ks1i    | <<#insn-aes64ks1i>>
|          | &#10003; | aes64ks2     | <<#insn-aes64ks2>>
|===

[[crypto_scalar_ext_zknd]]
=== `Zknd` - NIST Suite: AES Decryption

Instructions for accelerating the decryption and key-schedule functions of
the AES block cipher.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; |          | aes32dsi     | <<#insn-aes32dsi>>
| &#10003; |          | aes32dsmi    | <<#insn-aes32dsmi>>
|          | &#10003; | aes64ds      | <<#insn-aes64ds>>
|          | &#10003; | aes64dsm     | <<#insn-aes64dsm>>
|          | &#10003; | aes64im      | <<#insn-aes64im>>
|          | &#10003; | aes64ks1i    | <<#insn-aes64ks1i>>
|          | &#10003; | aes64ks2     | <<#insn-aes64ks2>>
|===

[[crypto_scalar_ext_zknh]]
=== `Zknh` - NIST Suite: Hash Function Instructions

Instructions for accelerating the SHA2 family of hash functions.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; | &#10003; | sha256sig0   | <<#insn-sha256sig0>>
| &#10003; | &#10003; | sha256sig1   | <<#insn-sha256sig1>>
| &#10003; | &#10003; | sha256sum0   | <<#insn-sha256sum0>>
| &#10003; | &#10003; | sha256sum1   | <<#insn-sha256sum1>>
| &#10003; |          | sha512sig0h  | <<#insn-sha512sig0h>>
| &#10003; |          | sha512sig0l  | <<#insn-sha512sig0l>>
| &#10003; |          | sha512sig1h  | <<#insn-sha512sig1h>>
| &#10003; |          | sha512sig1l  | <<#insn-sha512sig1l>>
| &#10003; |          | sha512sum0r  | <<#insn-sha512sum0r>>
| &#10003; |          | sha512sum1r  | <<#insn-sha512sum1r>>
|          | &#10003; | sha512sig0   | <<#insn-sha512sig0>>
|          | &#10003; | sha512sig1   | <<#insn-sha512sig1>>
|          | &#10003; | sha512sum0   | <<#insn-sha512sum0>>
|          | &#10003; | sha512sum1   | <<#insn-sha512sum1>>
|===

[[crypto_scalar_ext_zksed]]
=== `Zksed` - ShangMi Suite: SM4 Block Cipher Instructions

Instructions for accelerating the SM4 Block Cipher.
Note that unlike AES, this cipher uses the same core operation for
encryption and decryption, hence there is only one
extension for it.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; | &#10003; | sm4ed        | <<#insn-sm4ed>>
| &#10003; | &#10003; | sm4ks        | <<#insn-sm4ks>>
|===

[[crypto_scalar_ext_zksh]]
=== `Zksh` - ShangMi Suite: SM3 Hash Function Instructions

Instructions for accelerating the SM3 hash function.

[%header,cols="^1,^1,4,8"]
|===
|RV32
|RV64
|Mnemonic
|Instruction

| &#10003; | &#10003; | sm3p0        | <<#insn-sm3p0>>
| &#10003; | &#10003; | sm3p1        | <<#insn-sm3p1>>
|===


